# M1&M2 可扩展UI重设计方案

**日期**：2026-02-04
**目的**：解决素材无限扩展时的排版问题

---

## 📊 现状问题

### M1头像风格选择
- **当前**：模板选择页，每个风格1张预览图
- **问题**：
  - LoRA可以无限扩充（目前6个，未来可能20+个）
  - 换个提示词就是半新方案
  - 单页展示会非常拥挤

### M2写真换脸
- **当前**：模板选择页，展示所有模板
- **问题**：
  - 素材太多（男女各N张，分多个分类）
  - 卡片没有其他元素，只有背景图
  - 单页展示放不下

---

## ✅ M2换脸 - 已实现方案

### 设计思路
1. **分类Tab导航** - 顶部横向滚动Tab（传统、现代、创意、喜庆）
2. **2列瀑布流** - Pinterest式网格，支持无限滚动
3. **卡片极简化** - 只显示背景图，hover显示名称
4. **性别筛选** - 顶部性别切换
5. **动态计数** - 每个Tab显示模板数量

### 文件清单
```
✅ src/configs/festival/m2Templates.ts       - 配置文件
✅ src/pages/Festival/M2TemplateSelectionPage.tsx  - 页面组件
✅ src/styles/festival-m2-template.css      - 样式文件
```

### 效果预览
```
┌─────────────────────────────────────┐
│      选择写真场景                    │
│   选择你喜欢的造型风格               │
├─────────────────────────────────────┤
│  [👨 男生]  [👩 女生]               │
├─────────────────────────────────────┤
│ 🎯全部(7) 🏮传统风(7) ✨现代风(0)   │
│ 🎨创意风(0) 🎊喜庆风(0)  ← 横向滚动  │
├─────────────────────────────────────┤
│  财神、唐装、汉服等传统造型          │
├─────────────────────────────────────┤
│  ┌────────┐  ┌────────┐            │
│  │ 图片1  │  │ 图片2  │            │
│  │ 3:4    │  │ 3:4    │            │
│  └────────┘  └────────┘            │
│  ┌────────┐  ┌────────┐            │
│  │ 图片3  │  │ 图片4  │            │
│  └────────┘  └────────┘            │
│         ⋮                           │
├─────────────────────────────────────┤
│  [→ 继续上传照片]                   │
└─────────────────────────────────────┘
```

### 扩展性
- ✅ 添加新分类：在`M2_CATEGORIES`数组添加即可
- ✅ 添加新模板：在`M2_TEMPLATES`数组添加即可
- ✅ 自动过滤：没有模板的分类自动隐藏
- ✅ 响应式：移动端2列，平板3列，桌面4列

---

## 🎨 M1头像风格 - 推荐方案

### 方案A：卡片式（推荐）⭐️

**设计理念**：类似手机主题商店，每个风格是一张大卡片

```
┌─────────────────────────────────────┐
│      选择头像风格                    │
│   多种AI风格任你选择                 │
├─────────────────────────────────────┤
│  [👨 男生]  [👩 女生]               │
├─────────────────────────────────────┤
│ 🎯推荐 🔥热门 🆕最新 🎨全部风格      │
│       ← 横向滚动Tab                 │
├─────────────────────────────────────┤
│                                     │
│  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━┓      │
│  ┃  [大预览图 - 16:9]        ┃      │
│  ┃                            ┃      │
│  ┃  🌿 宫崎骏风格             ┃      │
│  ┃  吉卜力动画风格            ┃      │
│  ┃  [示例1] [示例2] [示例3]  ┃      │
│  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━┛      │
│                                     │
│  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━┓      │
│  ┃  [大预览图]                ┃      │
│  ┃  🎨 水彩春意               ┃      │
│  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━┛      │
│                                     │
│  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━┓      │
│  ┃  [大预览图]                ┃      │
│  ┃  ⚡ 赛博新春               ┃      │
│  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━┛      │
│                                     │
│         ⋮                           │
└─────────────────────────────────────┘
```

**特点**：
- 纵向滚动，每个风格占满屏宽
- 大预览图 + 3个小示例图（横向滚动）
- 显示风格名称、描述、标签
- 可展开查看更多示例

**优点**：
- 视觉冲击力强
- 展示内容丰富（可放多个示例）
- 支持无限扩展（纵向滚动）
- 适合强调风格差异

**缺点**：
- 占用空间大
- 需要准备更多素材

---

### 方案B：网格式（简洁）

**设计理念**：2列网格，类似M2设计

```
┌─────────────────────────────────────┐
│      选择头像风格                    │
├─────────────────────────────────────┤
│  [👨 男生]  [👩 女生]               │
├─────────────────────────────────────┤
│ 🎯全部 🔥热门 🆕最新 🎨经典          │
├─────────────────────────────────────┤
│  ┌───────────┐  ┌───────────┐      │
│  │  [预览图]  │  │  [预览图]  │      │
│  │  🌿 宫崎骏  │  │  🎨 水彩   │      │
│  │  免费       │  │  免费       │      │
│  └───────────┘  └───────────┘      │
│  ┌───────────┐  ┌───────────┐      │
│  │  [预览图]  │  │  [预览图]  │      │
│  │  ⚡ 赛博   │  │  🖌️ 厚涂   │      │
│  └───────────┘  └───────────┘      │
│         ⋮                           │
└─────────────────────────────────────┘
```

**特点**：
- 2列网格，卡片尺寸3:4
- 显示预览图 + 风格名
- 分类Tab筛选

**优点**：
- 简洁高效
- 一屏展示更多
- 与M2设计统一

**缺点**：
- 展示内容有限
- 风格差异不够明显

---

### 方案C：列表式（信息密集）

**设计理念**：横向卡片，类似音乐App

```
┌─────────────────────────────────────┐
│  ┌──┬─────────────────────────┐    │
│  │图│ 🌿 宫崎骏风格             │    │
│  │片│ 吉卜力动画风格            │→  │
│  └──┴─────────────────────────┘    │
│  ┌──┬─────────────────────────┐    │
│  │图│ 🎨 水彩春意               │    │
│  │片│ 艺术水彩画风格            │→  │
│  └──┴─────────────────────────┘    │
└─────────────────────────────────────┘
```

**特点**：
- 横向卡片，左图右文
- 一屏展示5-6个
- 点击展开查看详情

**优点**：
- 信息密集
- 快速浏览
- 节省空间

**缺点**：
- 视觉吸引力一般
- 不适合展示图片效果

---

## 📋 推荐实施方案

### M1：采用方案A（卡片式）

**理由**：
1. LoRA风格差异大，需要大图展示
2. 可以放多个示例，帮助用户决策
3. 纵向滚动体验好（类似小红书）
4. 支持无限扩展

**实施步骤**：
1. 为每个风格准备1张大预览图 + 3-5张小示例图
2. 创建`M1StyleCard`组件（大卡片）
3. 添加Tab分类（推荐、热门、最新、全部）
4. 添加标签系统（免费、会员、新）

### M2：已完成（Tab+网格）

**现状**：
- ✅ 分类Tab导航
- ✅ 2列瀑布流网格
- ✅ 极简卡片设计
- ✅ 支持无限扩展

---

## 🎯 M1具体实现方案

### 1. 数据结构扩展

```typescript
// src/configs/festival/m1Styles.ts

export interface M1StyleExtended {
  // 基础信息
  id: string;
  name: string;
  description: string;
  icon: string;

  // 展示素材
  coverImage: string;           // 大预览图（16:9）
  exampleImages: string[];      // 示例图（3-5张）

  // 分类标签
  category: 'recommend' | 'hot' | 'new' | 'all';
  tags: string[];               // 免费、会员、新、热门
  isFree: boolean;
  isNew: boolean;

  // 技术配置（原有）
  lora: { uuid: string; weight: number; ... };
  prompt_templates: { ... };
}
```

### 2. UI组件结构

```
M1StyleSelectionPage
├── Header（标题、性别选择）
├── CategoryTabs（推荐、热门、最新、全部）
├── StyleCardList
│   ├── StyleCard（大卡片）
│   │   ├── CoverImage（大预览图）
│   │   ├── StyleInfo（名称、描述）
│   │   ├── ExampleGallery（示例横向滚动）
│   │   └── ActionButton（选择按钮）
│   └── ...
└── BottomAction（继续按钮）
```

### 3. 样式要点

```css
/* 大卡片 */
.style-card-m1 {
  border-radius: 20px;
  overflow: hidden;
  margin-bottom: 20px;
  background: white;
}

/* 大预览图 */
.cover-image {
  aspect-ratio: 16/9;
  background-size: cover;
}

/* 示例图横向滚动 */
.example-gallery {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
}

.example-item {
  flex: 0 0 120px;
  aspect-ratio: 0.75;
  border-radius: 8px;
  scroll-snap-align: start;
}
```

---

## 🔄 后续扩展路径

### 阶段1：基础重构（本周）
- ✅ M2：Tab+网格（已完成）
- 🔲 M1：卡片式大图展示
- 🔲 素材准备（每个风格准备示例图）

### 阶段2：功能增强（下周）
- 🔲 搜索功能（按名称、标签搜索）
- 🔲 收藏功能（保存喜欢的风格）
- 🔲 最近使用（显示历史选择）

### 阶段3：高级功能（未来）
- 🔲 风格混合（选择2个风格融合）
- 🔲 参数调整（权重、强度滑块）
- 🔲 自定义风格（用户上传LoRA）

---

## 📊 对比总结

| 维度 | M1方案A（卡片式） | M1方案B（网格式） | M2方案（Tab+网格） |
|------|------------------|------------------|-------------------|
| 视觉冲击 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| 信息展示 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| 扩展性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 开发难度 | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| 素材需求 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |

**推荐**：
- **M1**：方案A（卡片式）- 适合展示风格差异
- **M2**：已实现Tab+网格 - 简洁高效

---

## 📁 文件清单

### 已创建（M2）
```
✅ src/configs/festival/m2Templates.ts
✅ src/pages/Festival/M2TemplateSelectionPage.tsx
✅ src/styles/festival-m2-template.css
```

### 待创建（M1）
```
🔲 src/configs/festival/m1StylesExtended.ts    - 扩展风格配置
🔲 src/pages/Festival/M1StyleSelectionPage.tsx - 新版风格选择页
🔲 src/styles/festival-m1-style.css           - 样式文件
🔲 src/components/StyleCard.tsx               - 风格卡片组件
🔲 src/components/ExampleGallery.tsx          - 示例图库组件
```

---

## 🎬 下一步行动

### 你（素材准备）
1. **M2素材扩展**：
   - 添加"现代风"分类素材（男女各3-5张）
   - 添加"创意风"分类素材（男女各3-5张）
   - 添加"喜庆风"分类素材（男女各3-5张）

2. **M1素材准备**：
   - 每个风格准备1张大预览图（16:9横版）
   - 每个风格准备3-5张小示例图（3:4竖版）
   - 共6个风格 × 4张 = 24张图

### 我（代码实现）
1. **测试M2页面**：
   - 路由配置
   - 与LabPage集成
   - 模板图路径验证

2. **实现M1新版页面**：
   - 创建M1StyleSelectionPage
   - 实现大卡片组件
   - 添加示例图横向滚动
   - 路由切换

3. **完善功能**：
   - 性别切换同步
   - 选中状态保持
   - 底部按钮交互

---

**总结**：M2已经完成可扩展设计，M1推荐采用卡片式大图展示，支持无限扩展！
