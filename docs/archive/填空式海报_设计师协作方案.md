# 填空式海报 - 设计师协作方案

**创建时间**: 2026-02-01
**目的**: 为福袋AI的分享海报功能，建立设计师与开发的标准化协作流程

---

## 📋 目录

1. [方案概述](#方案概述)
2. [设计师交付物规范](#设计师交付物规范)
3. [技术实现方式](#技术实现方式)
4. [协作流程](#协作流程)
5. [模板设计指南](#模板设计指南)
6. [技术对接文档](#技术对接文档)

---

## 方案概述

### 什么是填空式海报？

**定义**: 设计师提供固定的视觉模板，开发根据模板中标注的"填空区域"，动态填充用户生成的内容（图片、文字等）。

### 与传统方案的区别

| 方案 | 优点 | 缺点 | 是否采用 |
|------|------|------|---------|
| **传统方案** | 实现简单 | 图片+文字堆叠，无设计感 | ❌ 已废弃 |
| **填空式模板** | 专业设计+灵活填充 | 需要设计师配合 | ✅ **推荐** |
| **纯Canvas绘制** | 完全自由 | 设计成本高，难以维护 | ⚠️ 仅用于简单场景 |

---

## 设计师交付物规范

### 🎨 核心交付物

设计师需要为每个功能提供以下文件：

#### 1. 设计稿源文件
- **格式**: Figma / Sketch / Photoshop
- **尺寸**: 750px × 1334px（移动端标准尺寸）
- **分辨率**: @2x（1500px × 2668px）

#### 2. 切图资源

**背景层**:
```
poster-bg-M1.png         # M1新年3D头像的海报背景
poster-bg-M2.png         # M2财神变身的海报背景
poster-bg-M7.png         # M7运势抽卡的海报背景
...
```

**尺寸要求**:
- 宽度: 1500px（@2x）
- 高度: 2668px（@2x）
- 格式: PNG（透明通道） 或 JPG（纯色背景）

**装饰元素**（可选）:
```
poster-decoration-lantern.png   # 灯笼装饰
poster-decoration-cloud.png     # 祥云装饰
poster-decoration-coin.png      # 金币装饰
...
```

#### 3. 标注文档（重要！）

**格式**: JSON配置文件 + Figma标注截图

**示例 - `poster-config-M1.json`**:
```json
{
  "templateId": "M1",
  "templateName": "新年3D头像海报",
  "version": "1.0",
  "canvasSize": {
    "width": 750,
    "height": 1334
  },
  "background": {
    "image": "poster-bg-M1.png",
    "color": "#FFF5F0"
  },
  "fillAreas": [
    {
      "id": "user-photo",
      "type": "image",
      "position": {
        "x": 75,
        "y": 200,
        "width": 600,
        "height": 600
      },
      "style": {
        "borderRadius": 16,
        "shadow": {
          "color": "rgba(0, 0, 0, 0.1)",
          "blur": 20,
          "offsetY": 10
        }
      }
    },
    {
      "id": "title-text",
      "type": "text",
      "position": {
        "x": 375,
        "y": 880,
        "width": 600,
        "align": "center"
      },
      "style": {
        "fontFamily": "PingFang SC",
        "fontSize": 36,
        "fontWeight": "bold",
        "color": "#C41E3A",
        "lineHeight": 1.5
      },
      "maxLines": 2
    },
    {
      "id": "subtitle-text",
      "type": "text",
      "position": {
        "x": 375,
        "y": 960,
        "width": 600,
        "align": "center"
      },
      "style": {
        "fontFamily": "PingFang SC",
        "fontSize": 24,
        "color": "#666666",
        "lineHeight": 1.5
      },
      "maxLines": 3
    },
    {
      "id": "qr-code",
      "type": "qrcode",
      "position": {
        "x": 600,
        "y": 1180,
        "width": 120,
        "height": 120
      },
      "style": {
        "borderRadius": 8,
        "background": "#FFFFFF",
        "padding": 8
      }
    },
    {
      "id": "watermark-text",
      "type": "text",
      "position": {
        "x": 660,
        "y": 1310,
        "width": 200,
        "align": "center"
      },
      "style": {
        "fontFamily": "PingFang SC",
        "fontSize": 18,
        "color": "#999999"
      },
      "content": "福袋AI·马年大吉"
    }
  ],
  "decorations": [
    {
      "id": "lantern-left",
      "image": "poster-decoration-lantern.png",
      "position": {
        "x": 30,
        "y": 50,
        "width": 80,
        "height": 120
      }
    },
    {
      "id": "lantern-right",
      "image": "poster-decoration-lantern.png",
      "position": {
        "x": 640,
        "y": 50,
        "width": 80,
        "height": 120
      }
    }
  ]
}
```

#### 4. 设计稿标注截图

**内容要求**:
- 清晰标注每个填空区域的位置、尺寸
- 标注字体、字号、颜色
- 标注圆角、阴影等样式细节

**示例**:
```
标注截图命名:
- poster-M1-annotation-layout.png     # 整体布局标注
- poster-M1-annotation-text.png       # 文字样式标注
- poster-M1-annotation-style.png      # 视觉样式标注
```

---

## 技术实现方式

### 方式1: Canvas合成（推荐）

**适用场景**: 所有海报类型

**优点**:
- ✅ 完全控制像素级细节
- ✅ 支持复杂样式（阴影、渐变、圆角）
- ✅ 生成DataURL可直接下载或分享
- ✅ 跨平台兼容性好

**实现代码示例**:
```typescript
// 根据模板配置生成海报
export async function generatePoster(
  templateConfig: PosterTemplate,
  fillData: PosterFillData
): Promise<string> {
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d')!;

  // 设置Canvas尺寸
  canvas.width = templateConfig.canvasSize.width;
  canvas.height = templateConfig.canvasSize.height;

  // 1. 绘制背景
  await drawBackground(ctx, templateConfig.background);

  // 2. 绘制装饰元素
  for (const decoration of templateConfig.decorations) {
    await drawDecoration(ctx, decoration);
  }

  // 3. 填充用户内容
  for (const area of templateConfig.fillAreas) {
    await fillArea(ctx, area, fillData[area.id]);
  }

  // 4. 返回DataURL
  return canvas.toDataURL('image/png', 1.0);
}
```

### 方式2: HTML + html2canvas（备选）

**适用场景**: 需要复杂文字排版的场景

**优点**:
- ✅ 文字排版更灵活
- ✅ 支持CSS样式

**缺点**:
- ⚠️ 生成速度较慢
- ⚠️ 字体加载可能有问题

---

## 协作流程

### 阶段1: 需求对接（1天）

**参与人员**: 产品 + 设计师 + 前端开发

**产出物**:
- [ ] 确定需要设计海报的功能列表（如M1、M2、M7等）
- [ ] 确定每个功能的填充内容类型（图片、文字、二维码等）
- [ ] 确定海报尺寸和风格定位

**会议要点**:
1. 讲解"填空式模板"的概念和实现方式
2. 确定设计交付物规范
3. 确定设计排期

---

### 阶段2: 设计制作（3-5天）

**设计师工作**:
1. 根据功能特点设计海报模板
2. 标注填空区域的位置和样式
3. 输出切图资源
4. 输出配置JSON文件

**设计要点**:
- 保持福袋AI的春节主题（红金配色）
- 留出足够的内容填充区域
- 注意移动端屏幕尺寸限制
- 考虑不同长度文字的适配

**自查清单**:
- [ ] 背景图已导出（PNG/JPG）
- [ ] 装饰元素已单独导出
- [ ] JSON配置文件已编写
- [ ] 标注截图已保存
- [ ] 字体文件已说明（是否需要额外下载）

---

### 阶段3: 技术实现（2-3天）

**前端开发工作**:
1. 接收设计师交付物
2. 验证JSON配置文件格式
3. 实现Canvas绘制逻辑
4. 测试不同内容长度的适配
5. 优化性能和生成速度

**技术验收标准**:
- [ ] 海报生成速度 < 1秒
- [ ] 所有样式还原度 ≥ 95%
- [ ] 文字排版正确（不溢出、不遮挡）
- [ ] 图片裁剪和缩放正确
- [ ] 支持下载和分享功能

---

### 阶段4: 联调测试（1天）

**测试内容**:
- [ ] 不同长度的文字内容测试
- [ ] 不同尺寸的图片测试
- [ ] 边界情况测试（超长文字、极小图片等）
- [ ] 多设备测试（iPhone、Android、iPad）

**问题反馈**:
- 设计师：提供调整建议
- 开发：修复技术问题

---

### 阶段5: 上线发布（1天）

**上线前检查**:
- [ ] 所有功能的海报模板已完成
- [ ] 测试通过
- [ ] 性能达标
- [ ] 文档更新

---

## 模板设计指南

### 🎨 设计原则

#### 1. 移动端优先
- 海报尺寸: 750px × 1334px（iPhone标准尺寸）
- 安全区域: 留出30-40px的边距
- 关键内容在屏幕中心1/3区域

#### 2. 春节主题
- **配色**: 红金配色（#C41E3A + #FFD700）
- **元素**: 灯笼、祥云、金币、爆竹等
- **风格**: 现代简约，避免过于传统"土气"

#### 3. 留白和呼吸感
- 内容区域之间保持足够间距
- 避免元素过于拥挤
- 重要信息突出显示

#### 4. 品牌一致性
- 使用福袋AI的Logo和配色
- 统一的字体系统（PingFang SC / Noto Sans SC）
- 统一的视觉风格

---

### 📐 布局建议

**推荐布局结构**:
```
┌─────────────────────────┐
│  [装饰元素：灯笼等]       │  ← 顶部装饰（80-120px）
├─────────────────────────┤
│                         │
│  [用户生成的图片]         │  ← 主内容区（600-700px）
│  (M1头像/M2变身/M7卡片)  │
│                         │
├─────────────────────────┤
│  [标题文字]              │  ← 文字区（150-200px）
│  [副标题/描述]           │
├─────────────────────────┤
│  [二维码] [品牌水印]      │  ← 底部信息（150-200px）
└─────────────────────────┘
```

---

### 🎯 填空区域设计规范

#### 图片填空区域
- **尺寸**: 建议 600px × 600px（正方形）或 600px × 700px（竖图）
- **样式**: 圆角 16px，阴影 rgba(0,0,0,0.1) blur 20px
- **裁剪**: 支持等比缩放和居中裁剪

#### 文字填空区域
- **标题**: 32-40px，加粗，主题色
- **副标题**: 24-28px，常规，灰色
- **正文**: 20-24px，常规，深灰色
- **行高**: 1.5倍行距
- **最大行数**: 标题2行，副标题3行，正文5行

#### 二维码区域
- **尺寸**: 100-120px × 100-120px
- **位置**: 右下角或底部居中
- **样式**: 白色背景 + 8px圆角 + 轻微阴影
- **说明文字**: "扫码体验"或"长按识别"

---

### 🌟 装饰元素建议

**春节装饰元素**:
- 灯笼（红色、金色）
- 祥云（线描、渐变）
- 金币、元宝
- 烟花、爆竹
- 福字、春联
- 生肖马（马年特供）

**放置位置**:
- 顶部两侧：对称灯笼
- 四角：小型装饰点缀
- 背景：淡色祥云纹理
- 边框：金色线条或纹理

---

## 技术对接文档

### 📂 文件交付清单

**设计师交付给开发**:
```
poster-templates/
├── M1-新年3D头像/
│   ├── poster-bg-M1.png              # 背景图
│   ├── poster-config-M1.json         # 配置文件
│   ├── poster-M1-annotation-*.png    # 标注截图
│   └── decorations/
│       ├── lantern.png
│       └── cloud.png
├── M2-财神变身/
│   ├── poster-bg-M2.png
│   ├── poster-config-M2.json
│   └── ...
└── M7-运势抽卡/
    ├── poster-bg-M7.png
    ├── poster-config-M7.json
    └── ...
```

**开发交付给设计师**:
```
测试预览链接:
http://192.168.2.2:5174/poster-preview?template=M1

测试数据:
- 测试图片: [URL]
- 测试文字: "恭喜发财，万事如意！"
```

---

### 🔧 JSON配置字段说明

#### 坐标系统
- 原点: 左上角 (0, 0)
- X轴: 向右为正
- Y轴: 向下为正
- 单位: px（@1x分辨率）

#### 填空区域类型

**type: "image"** - 图片填充
```json
{
  "type": "image",
  "position": { "x": 75, "y": 200, "width": 600, "height": 600 },
  "style": {
    "borderRadius": 16,           // 圆角
    "objectFit": "cover",         // cover | contain
    "shadow": {                   // 阴影（可选）
      "color": "rgba(0,0,0,0.1)",
      "blur": 20,
      "offsetX": 0,
      "offsetY": 10
    }
  }
}
```

**type: "text"** - 文字填充
```json
{
  "type": "text",
  "position": { "x": 375, "y": 880, "width": 600, "align": "center" },
  "style": {
    "fontFamily": "PingFang SC",
    "fontSize": 36,
    "fontWeight": "bold",         // normal | bold
    "color": "#C41E3A",
    "lineHeight": 1.5
  },
  "maxLines": 2,                  // 最大行数
  "overflow": "ellipsis"          // ellipsis | clip
}
```

**type: "qrcode"** - 二维码
```json
{
  "type": "qrcode",
  "position": { "x": 600, "y": 1180, "width": 120, "height": 120 },
  "style": {
    "borderRadius": 8,
    "background": "#FFFFFF",
    "padding": 8
  }
}
```

---

### 🧪 测试用例

**提供给设计师的测试数据**:

```javascript
// M1新年3D头像
const testData_M1 = {
  'user-photo': 'https://example.com/user-avatar.png',
  'title-text': '恭喜发财，万事如意！',
  'subtitle-text': '福袋AI为你生成的专属新年头像',
  'qr-code': 'https://example.com/qrcode.png',
  'watermark-text': '福袋AI·马年大吉'
};

// M7运势抽卡
const testData_M7 = {
  'fortune-card': 'https://example.com/fortune-card.png',
  'title-text': '财源滚滚',
  'blessing-text': '马年财运亨通，财源滚滚而来！把握机遇，必有收获。',
  'qr-code': 'https://example.com/qrcode.png'
};
```

---

### 📞 沟通渠道

**问题反馈**:
- 技术问题 → 开发负责人
- 设计调整 → 设计师
- 需求变更 → 产品经理

**协作工具**:
- 设计稿: Figma链接
- 文件传输: 企业网盘 / Git LFS
- 沟通: 微信群 / 钉钉

---

## 附录：快速开始

### For 设计师

**第一次合作？按以下步骤开始**:

1. **阅读本文档** - 了解填空式模板的概念
2. **查看示例** - 参考 `poster-config-M1.json` 示例
3. **开始设计** - 使用Figma/Sketch设计海报
4. **标注填空区域** - 使用矩形标注工具
5. **导出资源** - 背景图 + 装饰元素
6. **编写JSON** - 根据标注编写配置文件
7. **自查** - 对照交付清单检查
8. **提交** - 将文件打包发送给开发

### For 开发

**接收到设计交付物后**:

1. **验证文件完整性** - 检查是否包含所有必需文件
2. **验证JSON格式** - 使用JSON校验工具检查
3. **实现Canvas绘制** - 参考 `PosterGenerator.ts`
4. **本地测试** - 使用测试数据生成海报预览
5. **联调** - 与设计师确认还原度
6. **优化** - 性能优化、边界处理
7. **上线** - 部署到生产环境

---

## 示例：完整的协作案例

### M1新年3D头像海报

**需求**:
- 展示用户生成的3D头像
- 添加祝福文案
- 右下角二维码引导扫码

**设计师交付**:
- ✅ `poster-bg-M1.png` (1500×2668px)
- ✅ `poster-config-M1.json`
- ✅ 标注截图 3张
- ✅ 装饰元素 2个（灯笼）

**开发实现**:
```typescript
const poster = await generatePoster(
  posterConfigM1,  // 设计师提供的配置
  {
    'user-photo': userGeneratedAvatar,
    'title-text': '恭喜发财，万事如意！',
    'subtitle-text': '福袋AI为你生成的专属新年头像',
    'qr-code': qrcodeImageUrl
  }
);
```

**最终效果**:
- ✅ 海报生成时间: 0.8秒
- ✅ 设计还原度: 98%
- ✅ 文字排版正确
- ✅ 图片显示完整

---

**文档维护**: 此文档应在协作流程优化后及时更新
**最后更新**: 2026-02-01
**联系人**: [开发负责人] / [设计负责人]
