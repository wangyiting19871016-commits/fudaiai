# CSS修改规范

**重要性**: 极高 - 违反规范已浪费大几十美金
**最后更新**: 2026-02-05

[返回总览](./开发规范-总览.md)

---

## CSS修改规范

### ⚠️ 血的教训
**已因违反此规范浪费大几十美金！**

### 核心原则
**永远不要盲目修改CSS，必须先全面检查所有覆盖关系。**

### 正确的CSS修改流程

#### 1. 修改前检查（必须）

```bash
# 搜索所有相关的CSS选择器
grep -r "\.class-name" src/styles/

# 或使用Grep工具
Grep pattern="\.class-name" path="src/styles/" output_mode="content"
```

**检查内容**:
- 是否有多个文件定义了同一个选择器
- 是否有更具体的选择器会覆盖（如 `.parent .child` 优先级高于 `.child`）
- 是否有 `!important` 标记
- CSS加载顺序：后加载的会覆盖先加载的

#### 2. 一次性修改所有相关位置

**错误做法 ❌**:
```
1. 修改 file1.css
2. 用户说没效果
3. 修改 file2.css
4. 用户说还是没效果
5. 修改 file3.css
6. ...（浪费大量时间和金钱）
```

**正确做法 ✅**:
```
1. Grep搜索所有相关选择器
2. 列出所有需要修改的位置
3. 一次性全部修改
4. 验证结果
```

#### 3. 第一次修改后没效果的处理

**如果用户反馈修改没生效，立即执行**:

1. **不要等用户催促**，立即主动检查
2. 用Grep搜索所有CSS文件中的相关选择器
3. 检查是否有覆盖关系
4. 找出所有覆盖的地方，一次性全部修改

**时间要求**: 1分钟内开始检查，不要拖延

### CSS优先级规则

#### 优先级从高到低:
1. `!important`
2. 内联样式 `style="..."`
3. ID选择器 `#id`
4. 类选择器 `.class`、属性选择器 `[attr]`、伪类 `:hover`
5. 元素选择器 `div`、伪元素 `::before`

#### 相同优先级时:
- **更具体的选择器优先**: `.parent .child` > `.child`
- **后加载的CSS优先**: 后面的覆盖前面的

#### 常见覆盖陷阱:

```css
/* ❌ 会被覆盖 */
.feature-name {
  color: black;
}

/* ✅ 优先级更高 */
.feature-info-v2 .feature-name {
  color: white;
}

/* ✅✅ 优先级最高 */
.feature-card-v2 .feature-info-v2 .feature-name {
  color: red;
}
```

### CSS文件加载顺序

**本项目的典型顺序**:
1. `festival-design-system.css` - 设计系统变量
2. `festival.css` - 基础样式
3. `festival-xxx-glass.css` - Glassmorphism风格覆盖

**注意**: 后加载的会覆盖先加载的！

### 修改前检查清单

- [ ] 用Grep搜索所有相关选择器
- [ ] 列出所有需要修改的文件和位置
- [ ] 检查CSS加载顺序
- [ ] 检查选择器优先级
- [ ] 一次性修改所有相关位置
- [ ] 如果第一次没生效，立即检查覆盖（不等用户催促）

---
