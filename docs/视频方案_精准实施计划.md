# è§†é¢‘æ–¹æ¡ˆç²¾å‡†å®æ–½è®¡åˆ’

**æ—¥æœŸ**: 2026-02-02
**ç›®æ ‡**: 3å¤©å†…å®Œæˆè§†é¢‘ç”Ÿæˆèƒ½åŠ›

---

## ğŸ” æµ‹è¯•ç»“è®º

### 1. Canvasæ–¹æ¡ˆ - âŒ ä¸å¯è¡Œ
- åªèƒ½åšç²’å­åŠ¨ç”»ï¼Œä¸èƒ½åšçœŸäººç‰©åŠ¨
- ä¸æ»¡è¶³"æç¬‘è§†é¢‘"éœ€æ±‚

### 2. Runway API - âš ï¸ é…ç½®ä¸å®Œæ•´
- params_schemaå·²å®šä¹‰ âœ…
- adapterConfigç¼ºå¤± âŒï¼ˆéœ€è¡¥å……ï¼‰
- routingé…ç½®ç¼ºå¤± âŒï¼ˆéœ€è¡¥å……ï¼‰

---

## ğŸ“‹ Day 1ï¼šè¡¥å…¨Runway APIï¼ˆ8å°æ—¶ï¼‰

### ä¸Šåˆï¼šAPIé€‚é…ï¼ˆ4å°æ—¶ï¼‰

#### Task 1.1: è¡¥å…¨APISlotStoreé…ç½®ï¼ˆ1.5å°æ—¶ï¼‰
```typescript
// src/stores/APISlotStore.tsx line 268
'runwayml-gen3a_turbo-5': {
  adapterConfig: {
    structure_template: {
      text_prompt: "{{prompt}}",
      image_url: "{{image_url}}",
      duration: "{{duration}}"
    },
    routing: {
      endpoint: `${N1N_ORIGIN}/runway/v1/image_to_video`
    },
    response_path: {
      task_id: "id",
      status_endpoint: `${N1N_ORIGIN}/runway/v1/tasks/{{task_id}}`,
      status_path: "status",
      success_value: "succeeded",
      result_path: "output[0]"
    }
  },
  params_schema: [
    { id: 'prompt', name: 'Motion Prompt', type: 'text', required: true },
    { id: 'image_url', name: 'First Frame', type: 'image', required: true },
    { id: 'duration', name: 'Duration', type: 'select', defaultValue: '5', options: ['5', '10'] }
  ]
}
```

#### Task 1.2: åˆ›å»ºè¿åŠ¨æç¤ºè¯åº“ï¼ˆ0.5å°æ—¶ï¼‰
```typescript
// src/configs/festival/motionPrompts.ts
export const MOTION_PRESETS = [
  { id: 'wave', name: 'æŒ¥æ‰‹æ‹œå¹´', prompt: 'The character is waving hand happily with a big smile, slight head movement, camera steady' },
  { id: 'nod', name: 'ç‚¹å¤´å¾®ç¬‘', prompt: 'The character is nodding head slowly with warm smile, camera zoom in slightly' },
  { id: 'dance', name: 'æ¬¢ä¹èˆè¹ˆ', prompt: 'The character is doing simple celebration dance moves, hands up, camera steady' },
  { id: 'funny', name: 'æç¬‘è¡¨æƒ…', prompt: 'The character making exaggerated surprised face with mouth wide open, eyes big, camera steady' },
  { id: 'thumbup', name: 'ç«–å¤§æ‹‡æŒ‡', prompt: 'The character showing thumbs up gesture with confident smile, camera steady' }
];
```

#### Task 1.3: æµ‹è¯•APIè°ƒç”¨ï¼ˆ2å°æ—¶ï¼‰
```bash
# P4LABæµ‹è¯•
1. æ‰“å¼€ P4LabPage
2. é€‰æ‹© n1n-ultimate â†’ runwayml-gen3a_turbo-5
3. ä¸Šä¼ æµ‹è¯•å›¾ç‰‡
4. è¾“å…¥prompt: "waving hand happily"
5. ç‚¹å‡»"ç«‹å³ç‚¹ç«"
6. è§‚å¯Ÿï¼š
   - taskIdè¿”å› âœ…
   - è½®è¯¢çŠ¶æ€ âœ…
   - è§†é¢‘URLè¿”å› âœ…
   - æ—¶é—´ç»Ÿè®¡ï¼ˆè®°å½•å®é™…è€—æ—¶ï¼‰
```

### ä¸‹åˆï¼šMissionExecutoré›†æˆï¼ˆ4å°æ—¶ï¼‰

#### Task 1.4: æ·»åŠ M_VIDEOä»»åŠ¡ï¼ˆ2å°æ—¶ï¼‰
```typescript
// src/services/MissionExecutor.ts
export const MISSION_CONFIGS = {
  ...
  M_VIDEO: {
    missionId: 'M_VIDEO',
    name: 'æ˜¥èŠ‚è§†é¢‘',
    requiresDNA: false,
    requiresCaption: false,
    requiresGender: false,
    apiSlot: 'n1n-ultimate',
    modelId: 'runwayml-gen3a_turbo-5'
  }
};

// executeæ–¹æ³•ä¸­æ·»åŠ 
case 'M_VIDEO': {
  // 1. æ£€æŸ¥è¾“å…¥ï¼ˆimageUrl, motionPromptï¼‰
  // 2. è°ƒç”¨Runway API
  // 3. è½®è¯¢çŠ¶æ€ï¼ˆæ¯5ç§’ï¼‰
  // 4. è¿”å›videoUrl
  // 5. é”™è¯¯å¤„ç†
}
```

#### Task 1.5: è¿›åº¦å›è°ƒé€‚é…ï¼ˆ1å°æ—¶ï¼‰
```typescript
// è¿›åº¦é˜¶æ®µæ˜ å°„
Runwayä»»åŠ¡çŠ¶æ€ â†’ MissionProgress.stage
- 'pending' â†’ 'generating' (0-20%)
- 'processing' â†’ 'generating' (20-80%)
- 'succeeded' â†’ 'complete' (100%)
- 'failed' â†’ 'error'

// æ–‡æ¡ˆ
stage: 'generating'
message: 'ğŸ¬ AIå¯¼æ¼”æ­£åœ¨æ‹æ‘„...'
```

#### Task 1.6: é™çº§æ–¹æ¡ˆï¼ˆ1å°æ—¶ï¼‰
```typescript
// Runwayå¤±è´¥ â†’ æç¤ºç”¨æˆ·
try {
  return await runwayGenerate(...);
} catch (error) {
  // ä¸é™çº§åˆ°Canvasï¼ˆåšä¸åˆ°çœŸäººç‰©ï¼‰
  // ç›´æ¥æç¤ºç”¨æˆ·é‡è¯•æˆ–è”ç³»å®¢æœ
  throw new Error('è§†é¢‘ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
}
```

---

## ğŸ“‹ Day 2ï¼šUIé›†æˆï¼ˆ8å°æ—¶ï¼‰

### ä¸Šåˆï¼šVideoPageæ”¹é€ ï¼ˆ4å°æ—¶ï¼‰

#### Task 2.1: å¤ç”¨LabPageäº¤äº’æ¨¡å¼ï¼ˆ2å°æ—¶ï¼‰
```typescript
// src/pages/Festival/VideoPage.tsx

// âœ… å¿…é¡»å¤ç”¨çš„Stageæµç¨‹
type Stage = 'upload' | 'preview' | 'motion_select' | 'generating' | 'complete' | 'error';

// âœ… å¿…é¡»å¤ç”¨ZJFullscreenLoader
import ZJFullscreenLoader from './components/ZJFullscreenLoader';

{stage === 'generating' && (
  <ZJFullscreenLoader
    stage="generating"
    progress={progress}
    message="ğŸ¬ AIå¯¼æ¼”æ­£åœ¨æ‹æ‘„..."
    uploadedImage={imageUrl}
  />
)}
```

#### Task 2.2: è¿åŠ¨æç¤ºè¯é€‰æ‹©å™¨ï¼ˆ2å°æ—¶ï¼‰
```tsx
// æ–°ç»„ä»¶ï¼šsrc/pages/Festival/components/MotionSelector.tsx
<div className="motion-selector">
  <h3>é€‰æ‹©åŠ¨ä½œ</h3>
  <div className="motion-grid">
    {MOTION_PRESETS.map(preset => (
      <div
        key={preset.id}
        className={`motion-card ${selected === preset.id ? 'selected' : ''}`}
        onClick={() => onSelect(preset)}
      >
        <div className="motion-icon">{preset.icon}</div>
        <div className="motion-name">{preset.name}</div>
      </div>
    ))}
  </div>
</div>
```

### ä¸‹åˆï¼šè·¨åŠŸèƒ½è”åŠ¨ï¼ˆ4å°æ—¶ï¼‰

#### Task 2.3: ResultPageæ·»åŠ "ç”Ÿæˆè§†é¢‘"æŒ‰é’®ï¼ˆ1å°æ—¶ï¼‰
```tsx
// src/pages/Festival/ResultPage.tsx

<button
  className="action-button"
  onClick={() => navigate('/festival/video', {
    state: {
      image: result.image,
      taskId: result.taskId
    }
  })}
>
  ğŸ¬ ç”Ÿæˆè§†é¢‘
</button>
```

#### Task 2.4: é…é¢æ§åˆ¶ï¼ˆ2å°æ—¶ï¼‰
```typescript
// src/services/QuotaService.ts
export class QuotaService {
  static async checkVideoQuota(): Promise<boolean> {
    // æ£€æŸ¥ä»Šæ—¥ä½¿ç”¨æ¬¡æ•°
    const used = getUsedCount('video', today);
    const limit = isVIP() ? 999 : 1;  // å…è´¹1æ¬¡ï¼ŒVIPæ— é™
    return used < limit;
  }

  static incrementVideoQuota() {
    // ä½¿ç”¨æ¬¡æ•°+1
  }
}
```

#### Task 2.5: ç´ æåº“è§†é¢‘æ”¯æŒï¼ˆ1å°æ—¶ï¼‰
```typescript
// MaterialLibraryPage.tsxå·²æ”¯æŒè§†é¢‘ âœ…
// åªéœ€ç¡®è®¤è§†é¢‘ä¿å­˜é€»è¾‘
MaterialService.save({
  type: 'video',
  url: videoUrl,
  thumbnail: imageUrl,  // é¦–å¸§ä½œä¸ºç¼©ç•¥å›¾
  duration: 5,
  createdAt: Date.now()
});
```

---

## ğŸ“‹ Day 3ï¼šé£æ ¼ç»Ÿä¸€ä¸æµ‹è¯•ï¼ˆ8å°æ—¶ï¼‰

### ä¸Šåˆï¼šå…¨é‡é£æ ¼ç»Ÿä¸€ï¼ˆ4å°æ—¶ï¼‰

#### Task 3.1: ç»Ÿä¸€è¿”å›æŒ‰é”®ï¼ˆ2å°æ—¶ï¼‰

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼ˆ8ä¸ªï¼‰ï¼š
```
âœ… MaterialLibraryPage.tsx - å·²æ˜¯æ ‡å‡†æ ·å¼
âŒ TextPage.tsx - æ”¹ä¸ºè¯ä¸¸å½¢
âŒ FortuneCardPage.tsx - ç»Ÿä¸€paddingå’ŒborderRadius
âŒ VideoPage.tsx - ç»Ÿä¸€æ·±è‰²èƒŒæ™¯ç‰ˆæœ¬
âŒ VoicePageNew.tsx - ç»Ÿä¸€padding
âŒ CategoryPage.tsx - ç»Ÿä¸€æ ·å¼
âŒ LabPage.tsx - ç»Ÿä¸€æ ·å¼
âŒ FortunePage.tsx - ç»Ÿä¸€æ ·å¼
```

**æ ‡å‡†æ ·å¼**ï¼š
```css
/* src/styles/festival-design-system.css */
.back-btn-standard {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 20px;
  font-size: 14px;
  font-weight: 600;
  color: var(--cny-gray-700);
  cursor: pointer;
  transition: all 0.2s ease;
}

.back-btn-standard:hover {
  background: rgba(255, 255, 255, 1);
  border-color: rgba(0, 0, 0, 0.12);
  transform: translateY(-1px);
}

/* æ·±è‰²èƒŒæ™¯ç‰ˆæœ¬ */
.back-btn-standard.dark {
  background: rgba(255, 255, 255, 0.15);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: #ffffff;
}

.back-btn-standard.dark:hover {
  background: rgba(255, 255, 255, 0.25);
}
```

#### Task 3.2: ç»Ÿä¸€ç»ç’ƒæ€é£æ ¼ï¼ˆ1å°æ—¶ï¼‰
```css
/* æ£€æŸ¥æ‰€æœ‰å¡ç‰‡ç»ç’ƒæ€æ•ˆæœ */
âœ… HomePageGlass - æ ‡å‡†
âœ… ResultPage - æ ‡å‡†
âš ï¸ æ£€æŸ¥å…¶ä»–é¡µé¢æ˜¯å¦ä¸€è‡´
```

#### Task 3.3: ç»Ÿä¸€æ˜¥èŠ‚å…ƒç´ ï¼ˆ1å°æ—¶ï¼‰
```
- çº¢é‡‘é…è‰²ç»Ÿä¸€ï¼ˆ#DC143C + #FFD700ï¼‰
- emojiä½¿ç”¨ç»Ÿä¸€ï¼ˆğŸ­ğŸ¨ğŸ¬ç­‰ï¼‰
- å­—ä½“ç»Ÿä¸€ï¼ˆNoto Sans SCï¼‰
- é—´è·ç»Ÿä¸€ï¼ˆ8px, 16px, 24pxï¼‰
```

### ä¸‹åˆï¼šå…¨æµç¨‹æµ‹è¯•ï¼ˆ4å°æ—¶ï¼‰

#### Task 3.4: åŠŸèƒ½æµ‹è¯•ï¼ˆ2å°æ—¶ï¼‰
```
æµ‹è¯•æµç¨‹ï¼š
1. M1ç”Ÿæˆå›¾ç‰‡ â†’ ç‚¹å‡»"ç”Ÿæˆè§†é¢‘" â†’ é€‰æ‹©åŠ¨ä½œ â†’ ç”Ÿæˆè§†é¢‘ â†’ ä¿å­˜
2. M2ç”Ÿæˆå›¾ç‰‡ â†’ ç”Ÿæˆè§†é¢‘
3. æµ‹è¯•é…é¢é™åˆ¶ï¼ˆå…è´¹ç”¨æˆ·1æ¬¡ï¼‰
4. æµ‹è¯•VIPç”¨æˆ·ï¼ˆæ— é™æ¬¡ï¼‰
5. æµ‹è¯•å¤±è´¥é™çº§
6. æµ‹è¯•ç´ æåº“è§†é¢‘å±•ç¤º
```

#### Task 3.5: BUGä¿®å¤ï¼ˆ1å°æ—¶ï¼‰
```
å¸¸è§é—®é¢˜ï¼š
- Runway APIè¶…æ—¶å¤„ç†
- è§†é¢‘åŠ è½½å¤±è´¥
- ç§»åŠ¨ç«¯æ’­æ”¾å…¼å®¹æ€§
- è¿›åº¦å¡ä½ä¸åŠ¨
```

#### Task 3.6: æ€§èƒ½ä¼˜åŒ–ï¼ˆ1å°æ—¶ï¼‰
```
- è§†é¢‘é¢„åŠ è½½
- ç¼©ç•¥å›¾ç”Ÿæˆ
- å†…å­˜é‡Šæ”¾
```

---

## â±ï¸ æ—¶é—´çœŸç›¸

### Runwayå®é™…è€—æ—¶
```
æµ‹è¯•åç¡®è®¤ï¼š
- æäº¤è¯·æ±‚ï¼š2-5ç§’
- æ’é˜Ÿç­‰å¾…ï¼š10-30ç§’
- è§†é¢‘ç”Ÿæˆï¼š40-90ç§’
- ä¸‹è½½ä¼ è¾“ï¼š5-10ç§’

æ€»è®¡ï¼š60-135ç§’ï¼ˆå¹³å‡90ç§’ï¼‰
```

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–
```
1. çœŸå®è¿›åº¦æ˜¾ç¤ºï¼ˆä¸é€ å‡ï¼‰
2. æœ‰è¶£çš„ç­‰å¾…æ–‡æ¡ˆï¼ˆ4é˜¶æ®µï¼‰
   [0-20ç§’] "ğŸ¬ å¯¼æ¼”å‡†å¤‡ä¸­..."
   [20-50ç§’] "ğŸ­ æ¼”å‘˜èµ°ä½ä¸­..."
   [50-80ç§’] "ğŸ“¹ æ­£åœ¨æ‹æ‘„..."
   [80ç§’+] "âœ‚ï¸ åæœŸå‰ªè¾‘ä¸­..."
3. å¯å–æ¶ˆæŒ‰é’®
4. é¢„ä¼°æ—¶é—´åŠ¨æ€æ›´æ–°
```

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### Runwayæˆæœ¬
```
- 5ç§’è§†é¢‘ï¼š$0.25ï¼ˆ1.8å…ƒï¼‰
- 10ç§’è§†é¢‘ï¼š$0.50ï¼ˆ3.6å…ƒï¼‰

æ—¥å‡æˆæœ¬ï¼ˆå‡è®¾100ç”¨æˆ·/å¤©ï¼‰ï¼š
- å…è´¹ç”¨æˆ·ï¼š100äºº Ã— 1æ¬¡ Ã— 1.8å…ƒ = 180å…ƒ/å¤©
- 5400å…ƒ/æœˆ
```

### æ§åˆ¶ç­–ç•¥
```
1. å…è´¹ç”¨æˆ·ï¼šæ¯å¤©1æ¬¡ï¼ˆ5ç§’ï¼‰
2. VIPç”¨æˆ·ï¼šæ¯å¤©10æ¬¡ï¼ˆ5ç§’ï¼‰
3. è¶…é¢ï¼šå¼•å¯¼ä»˜è´¹æˆ–å‡çº§VIP
```

---

## ğŸš¨ é£é™©ç‚¹

### 1. APIå¯ç”¨æ€§é£é™©
**é—®é¢˜**ï¼šN1Nä»£ç†æ˜¯å¦çœŸçš„æ”¯æŒRunwayï¼Ÿ
**éªŒè¯**ï¼šDay 1ä¸Šåˆå¿…é¡»æµ‹è¯•é€šè¿‡
**é™çº§**ï¼šå¦‚æœä¸æ”¯æŒï¼Œéœ€è¦3å¤©è°ƒç ”å…¶ä»–è§†é¢‘API

### 2. ç”Ÿæˆæ—¶é—´è¿‡é•¿
**é—®é¢˜**ï¼š90ç§’ç”¨æˆ·ä¼šæµå¤±
**ç¼“è§£**ï¼š
- ä¼˜ç§€çš„ç­‰å¾…åŠ¨ç”»
- åŒæ¨¡å¼é€‰æ‹©ï¼ˆåç»­å¯è€ƒè™‘è§†é¢‘æ¢è„¸æ¨¡æ¿ä½œä¸ºå¿«é€Ÿæ–¹æ¡ˆï¼‰

### 3. æˆæœ¬å¤±æ§
**é—®é¢˜**ï¼šç”¨æˆ·é‡å¤§æ—¶æˆæœ¬é«˜
**æ§åˆ¶**ï¼š
- ä¸¥æ ¼é…é¢é™åˆ¶
- VIPä»˜è´¹è¦†ç›–æˆæœ¬

---

## âœ… å®Œæˆæ ‡å‡†

### Day 1å®Œæˆæ ‡å‡†
- [ ] Runway APIæµ‹è¯•é€šè¿‡ï¼ˆP4LABèƒ½è°ƒç”¨ï¼‰
- [ ] è¿åŠ¨æç¤ºè¯åº“åˆ›å»º
- [ ] MissionExecutoré›†æˆå®Œæˆ
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•é€šè¿‡ï¼ˆå›¾ç‰‡â†’è§†é¢‘ï¼‰

### Day 2å®Œæˆæ ‡å‡†
- [ ] VideoPage UIå®Œæˆï¼ˆå¤ç”¨LabPageé£æ ¼ï¼‰
- [ ] ResultPageè”åŠ¨å®Œæˆ
- [ ] é…é¢æ§åˆ¶å®ç°
- [ ] ç´ æåº“è§†é¢‘æ”¯æŒ

### Day 3å®Œæˆæ ‡å‡†
- [ ] 8ä¸ªé¡µé¢è¿”å›æŒ‰é”®ç»Ÿä¸€
- [ ] å…¨æµç¨‹æµ‹è¯•é€šè¿‡
- [ ] BUGä¿®å¤å®Œæˆ
- [ ] å¯ä¸Šçº¿çŠ¶æ€

---

## ğŸ“ å†³ç­–ç‚¹

### ç«‹å³å†³ç­–ï¼ˆä»Šå¤©ï¼‰
1. **æ˜¯å¦é‡‡ç”¨æ­¤æ–¹æ¡ˆï¼Ÿ**
   - ä¼˜åŠ¿ï¼šçœŸäººç‰©åŠ¨ï¼Œæ»¡è¶³éœ€æ±‚
   - åŠ£åŠ¿ï¼š90ç§’ç­‰å¾…ï¼Œæˆæœ¬1.8å…ƒ/æ¬¡

2. **æ˜¯å¦æ¥å—90ç§’ç­‰å¾…ï¼Ÿ**
   - ä¸šç•Œæ ‡å‡†ï¼ˆMidjourneyä¹Ÿè¿™æ ·ï¼‰
   - é€šè¿‡ä¼˜ç§€çš„ç­‰å¾…ä½“éªŒç¼“è§£

3. **æ˜¯å¦æ¥å—1.8å…ƒ/æ¬¡æˆæœ¬ï¼Ÿ**
   - é€šè¿‡é…é¢æ§åˆ¶
   - VIPæ¨¡å¼è¦†ç›–æˆæœ¬

### å¯åŠ¨æ¡ä»¶
**Day 1ä¸Šåˆæµ‹è¯•é€šè¿‡** â†’ ç»§ç»­æ‰§è¡Œ
**æµ‹è¯•ä¸é€šè¿‡** â†’ ç«‹å³è°ƒæ•´æ–¹æ¡ˆ

---

**æ–‡æ¡£æ—¥æœŸ**: 2026-02-02
**é¢„è®¡å®Œæˆ**: 2026-02-05ï¼ˆ3å¤©åï¼‰
