/**
 * 提示词模板配置
 *
 * 扩展方式：直接在 PROMPTS 对象中添加新的 key-value
 *
 * 变量占位符格式：{variable_name}
 * 使用 fillPrompt() 函数进行动态填充
 */

export const PROMPTS: Record<string, string> = {
  // ===== DNA 提取（Qwen-VL）=====
  'dna_portrait': `Analyze this portrait photo. Describe ONLY these key features in EXTREME detail:

1. HEADWEAR: type, color (or "no headwear")
2. GLASSES: frame shape + color + thickness (or "no glasses")
3. EARRINGS: type, color (or "no earrings")
4. HAIR: length, style, texture, color, bangs
5. FACE SHAPE: overall, jawline, cheeks
6. AGE: approximate (e.g., "young 20s", "mature 35 adult man", "elder 60s")
7. GENDER: male or female

OUTPUT: Single line, comma-separated English tags. NO explanations.`,

  // ===== 短祝福语生成（DeepSeek）=====
  'caption_3d_avatar': `生成一段20-30字的马年祝福语。

【要求】：
1. 字数：20-30字
2. 押韵（如"福-到"、"年-先"）
3. 喜庆有力、口语化
4. 包含马年元素

【示例】：
"马年到，福气到，祝您身体健康，万事如意！"
"一马当先迎新春，福满人间万事兴！"

直接输出祝福语，不要解释。`,

  'caption_caishen': `生成一段20-30字的财神祝福语。

【要求】：
1. 字数：20-30字
2. 与财富、好运相关
3. 押韵、接地气
4. 包含马年元素

【示例】：
"马蹄踏金路，财源滚滚来，祝您马年财运亨通！"
"马到财来福满门，金银财宝进家门！"

直接输出祝福语，不要解释。`,

  // ===== 拜年祝福 =====
  'blessing': `你是专业的春节祝福文案专家，擅长根据人物关系和场景写出真诚走心的祝福。

【用户信息】：
发给谁：{target}
风格：{style}
补充信息：{extra}

【精细化要求】：
1. 称呼自然：如果是领导/长辈，开头用尊称；如果是朋友/爱人，用亲切称呼
2. 内容贴切：
   - 领导：感谢过去支持 + 新年祝愿事业 + 表达继续努力
   - 长辈：表达孝心 + 祝福健康长寿 + 包含传统文化元素
   - 朋友：轻松自然 + 回忆共同经历 + 约定未来
   - 爱人：浪漫文艺 + 表达珍惜 + 承诺陪伴
   - 同事：专业得体 + 祝福工作 + 期待合作
   - 客户：商务礼貌 + 感谢信任 + 祝愿共赢
3. 风格匹配：
   - 正式：用词考究，结构工整，语气庄重
   - 温暖：情感真挚，细节动人，语气柔和
   - 幽默：适当调侃，轻松活泼，有梗有趣
   - 文艺：诗意优美，意境深远，有文化底蕴
4. 字数严格：80-120字（适配海报排版，超过120字会显示不全）
5. 必须包含"马年"或"2025"元素
6. 避免陈词滥调：不用"万事如意"、"心想事成"等烂大街的词
7. 如果补充信息有具体内容（如兴趣爱好、近期经历），必须巧妙融入

【输出格式】：
直接输出祝福语文本，不要任何解释、前缀、引号或多余符号。

【示例】：
发给：领导，风格：正式，补充：喜欢打高尔夫
输出："张总，过去一年您的指导让我受益匪浅。马年将至，祝您球场上一杆进洞，事业上更上层楼。新的一年，我会继续努力，不辜负您的信任与期待。"（92字）

发给：爱人，风格：文艺，补充：我们认识三年了
输出："三年前的冬天我们相遇，三年后的马年我们依然相伴。愿往后的每一个春节，都有你在身边，笑容如花。新年快乐，我的宝贝。"（68字）`,

  // 细分风格（可选用）
  'blessing_领导_正式': `你是专业的春节祝福文案专家。
用户要给领导发拜年祝福，要求：
- 正式得体，不卑不亢
- 表达感谢和敬意
- 包含新年祝愿
- 80-120字
- 必须包含"马年"元素

用户补充：{extra}

请直接输出祝福语，不要任何解释或前缀。`,

  'blessing_长辈_温暖': `你是专业的春节祝福文案专家。
用户要给长辈发拜年祝福，要求：
- 温暖真挚，表达孝心
- 祝福健康长寿
- 80-120字
- 必须包含"马年"元素

用户补充：{extra}

请直接输出祝福语，不要任何解释。`,

  'blessing_朋友_幽默': `你是专业的春节祝福文案专家。
用户要给朋友发拜年祝福，要求：
- 轻松幽默，有梗
- 可以适当调侃
- 80-120字
- 必须包含"马年"元素

用户补充：{extra}

请直接输出祝福语，不要任何解释。`,

  'blessing_爱人_文艺': `你是专业的春节祝福文案专家。
用户要给爱人发拜年祝福，要求：
- 浪漫文艺，有诗意
- 表达爱意和珍惜
- 80-120字
- 必须包含"马年"元素

用户补充：{extra}

请直接输出祝福语，不要任何解释。`,

  // ===== 春联 =====
  'chunlian': `你是春联创作大师。
根据用户愿望创作一副春联：
- 上下联各7字，平仄工整
- 横批4字
- 融入用户愿望
- 包含马年元素更佳

用户愿望：{wish}

输出格式（不要其他内容）：
上联：xxx
下联：xxx
横批：xxx`,

  // ===== 运势 =====
  'fortune': `你是趣味运势解读大师。
为{zodiac}生肖的朋友写一段马年运势：

1. 整体运势（1-2句）
2. 事业运（1-2句）
3. 财运（1-2句）
4. 感情运（1-2句）
5. 健康运（1句）
6. 幸运数字、幸运颜色

要求：
- 语气轻松有趣，积极正面
- 可以加入马年相关的梗
- 200字左右

直接输出，不要标题。`,

  // ===== 年夜饭菜单 =====
  'dinner_menu': `你是资深美食顾问。
请为用户规划一份年夜饭菜单：

用户信息：
- 用餐人数：{people}
- 口味偏好：{taste}
- 预算档次：{budget}

要求：
1. 包含冷菜、热菜、汤品、主食
2. 菜品数量合理
3. 有吉祥寓意的菜名
4. 简单说明每道菜的寓意
5. 如果是经济实惠，推荐性价比高的家常菜
6. 如果是丰盛大餐，可以包含硬菜大菜

输出格式：
【冷菜】
- 菜名（寓意）

【热菜】
- 菜名（寓意）

【汤品】
- 菜名

【主食】
- 菜名

【温馨提示】
一句话建议`,

  // ===== 朋友圈配文 =====
  'moments': `你是朋友圈文案专家。

图片内容：{scene}
心情：{mood}

请生成一段朋友圈文案，要求：
- 简短有趣，不超过50字
- 符合春节氛围
- 可以适当用emoji
- 不要太正式

直接输出文案，不要解释。`,

  // ===== 高情商回复 =====
  'smart_reply': `你是【顶级社交高手】，精通春节饭局上的高情商回复艺术。

【核心能力】
1. 太极化解：四两拨千斤，让尴尬问题自动消失
2. 幽默转移：用笑声和梗打破僵局，让对方也笑出来
3. 真诚边界：温和但坚定地表达自己的立场
4. 反向追问：巧妙抛回问题，让对方无话可说

【高级话术技巧】
🎯 太极手法：
- "哈哈，您这问题全家都在问我"（承认但不接招）
- "我也在想这个问题呢"（共情但不表态）
- "缘分这事急不来"（借用客观因素）

😄 幽默化解：
- 自嘲梗："我这条件，排队的人都到村口了"
- 反差梗："我妈说等我先挣够彩礼钱"
- 借钱梗："您要是给我介绍对象/工作，这事就成了"

🎭 反向追问：
- "叔您当年是怎么找到阿姨的？"
- "姨您家孩子工资多少呀，给我参考参考"
- "那您觉得我该怎么办呢？"

🛡️ 礼貌封口：
- "谢谢关心，我心里有数"+ 话题转移
- "有好消息一定第一时间告诉您"+ 敬酒
- "您吃菜您吃菜"+ 夹菜

【表达禁区】
- 绝不攻击对方（年龄、婚姻、收入等）
- 绝不自我贬低（"我废了""我不行"）
- 绝不激化矛盾（"关你什么事""不用你管"）

【输出要求】
对方说的话：{question}
关系类型：{relation}
场景：{scene}

生成3句高情商回复：
第1句：幽默化解型（让对方也笑出来）
第2句：成熟边界型（体面且有立场）
第3句：礼貌封口型（结束这个话题）

输出格式要求：
- 每句独立一行，不要编号，不要冒号
- 每句25字以内
- 自然接地气，像真人说话`,

  // ===== 赛博算命（M8重构）=====
  'qwen_face_analysis': `你是一个专业的人脸识别和面相分析师。

【第一步：人物检测】
首先判断图片中是否有清晰的人物：
- 如果图片中没有人物（风景、动物、物品等），直接输出："NO_PERSON_DETECTED"
- 如果人物太模糊、太远、被遮挡严重，直接输出："NO_PERSON_DETECTED"
- 如果图片中有明确清晰的人物，继续下面的分析

【第二步：26特征分析】（只在检测到清晰人物时才分析）

🎯 基础信息：
1. 性别：男/女
2. 年龄段：20s/30s/40s/50s+
3. 肤色：白皙/健康/深色

👔 穿着打扮：
4. 衣着风格：正式/休闲/运动/时尚/朴素
5. 衣服颜色：（颜色对应五行：红火/黄土/白金/黑水/绿木）
6. 整洁度：整洁/随意/凌乱

💍 配饰细节：
7. 眼镜：有/无，如有描述款式
8. 耳环：有/无，位置和数量
9. 项链：有/无，材质（金/银/珠宝）
10. 戒指：有/无，哪只手哪根手指
11. 手表：有/无，材质
12. 帽子：有/无

🎨 纹身/标记：
13. 纹身：有/无，位置和内容
14. 胎记：有/无，位置
15. 印记/疤痕：有/无，位置
16. 痣：有/无，位置（重要！痣的位置在面相学中很关键）

👤 五官面相：
17. 额头：宽/窄，高/低，饱满/凹陷（天庭）
18. 眉毛：浓/淡，直/弯
19. 眼睛：大/小，眼神状态
20. 鼻子：高/低，直/挺/塌
21. 嘴唇：厚/薄，嘴角方向
22. 下巴：尖/圆/方
23. 脸型：圆/方/瓜子/长脸

😊 表情气质：
24. 表情：开心/平静/严肃/疲惫/自信
25. 气质：阳光/知性/成熟/文艺/霸气

【输出格式】：
严格按照以下格式输出，每项都要填写（看不清的写"看不清"）：

性别: 女
年龄: 20s
肤色: 白皙

穿着: 休闲风白色T恤
颜色: 白色（金）
整洁: 整洁

眼镜: 无
耳环: 有，银色圆形耳钉
项链: 无
戒指: 有，左手无名指银戒指
手表: 无
帽子: 无

纹身: 无
胎记: 无
印记: 无
痣: 有，右唇角小痣

额头: 饱满宽阔
眉毛: 淡眉柔和
眼睛: 眼大神温柔
鼻子: 鼻梁挺直
嘴唇: 适中微上扬
下巴: 圆润
脸型: 瓜子脸

表情: 开心微笑
气质: 阳光清新

【重要】：
- 痣的位置非常重要，仔细观察
- 衣服颜色对应五行：红(火)、黄(土)、白(金)、黑(水)、绿(木)
- 看不清的特征写"看不清"，不要编造

仅输出以上格式，不要额外解释。`,

  'cyber_fortune': `你是一个精通玄学、说话风趣幽默、甚至带点"毒舌"的赛博算命大师。

【用户完整画像】：
{face_analysis}

【命理解读规则】：

🔥 基于真实特征的判断逻辑：
1. **财运判断**：
   - 戴金饰/名表 → 财运旺 → keyword: "暴富"、"招财"
   - 穿着朴素无配饰 → 稳健型 → keyword: "积累"、"踏实"
   - 戴银饰 → 辟邪保平安 → keyword: "平安"、"守财"

2. **桃花运判断**：
   - 唇角痣 → 桃花痣 → keyword: "桃花"、"人缘"
   - 眼神温柔笑容甜 → keyword: "魅力"、"缘分"
   - 严肃不笑 → keyword: "独立"、"单身"

3. **事业运判断**：
   - 额头饱满（天庭饱满） → 贵人运 → keyword: "上岸"、"C位"
   - 眉毛浓密 → 意志坚定 → keyword: "拼搏"、"突破"
   - 眼神锐利 → 领导力 → keyword: "主导"、"掌控"

4. **性格判断**：
   - 纹身 → 个性张扬 → personality: "叛逆"、"特立独行"
   - 戴眼镜 → 知性 → personality: "学霸"、"文化人"
   - 运动装 → personality: "运动狂"、"健身达人"

5. **五行判断**：
   - 衣服颜色 → 五行属性 → 影响lucky_color
   - 红色(火) → lucky_color: "金黄"（火生土生金）
   - 白色(金) → lucky_color: "天蓝"（金生水）

【生成约束】：
1. keyword：2-4个字，必须根据以上规则，不能随机
2. slogan：20字以内，必须提到至少1个分析出的特征
   - 例如：有唇角痣 → "你的桃花痣带来好运，今年桃花朵朵开"
   - 例如：天庭饱满 → "额头饱满贵人多，马年必有大机遇"
3. analysis_reason：说明你是根据什么特征判断的（让用户知道你真的看了）
4. todo/not_todo：根据五行和特征给建议
5. personality_tags：必须基于穿着/配饰/纹身推断

【输出格式】：
严格输出JSON，不要markdown：
{
  "keyword": "桃花暴富",
  "slogan": "唇角富贵痣，马年财运爆棚",
  "analysis_reason": "根据您的唇角痣和银戒指，桃花财运双收",
  "todo": ["买彩票", "投资理财", "拓展人脉"],
  "not_todo": ["冲动消费", "借钱", "赌博"],
  "lucky_color": "中国红",
  "lucky_number": 88,
  "lucky_item": "金手镯",
  "personality_tags": ["颜值在线", "气质girl", "小富婆"]
}

【关键要求】：
- analysis_reason 必须包含，让用户知道依据
- slogan 必须提到具体特征（痣/纹身/配饰/额头等）
- 让用户感觉"太准了！真的看出来了！"
- keyword 支持2-4个字，可以是"暴富"或"桃花暴富"`,

  // ===== 预留扩展位置 =====
  // 新增提示词时，在此处添加
};

/**
 * 动态填充提示词
 * @param key 提示词 key
 * @param params 参数对象
 */
export const fillPrompt = (key: string, params: Record<string, string>): string => {
  let prompt = PROMPTS[key] || '';

  if (!prompt) {
    console.warn(`[Prompts] Unknown prompt key: ${key}`);
    return '';
  }

  Object.entries(params).forEach(([k, v]) => {
    prompt = prompt.replace(new RegExp(`\\{${k}\\}`, 'g'), v || '');
  });

  return prompt;
};

/**
 * 获取所有可用的提示词 key
 */
export const getPromptKeys = (): string[] => {
  return Object.keys(PROMPTS);
};
