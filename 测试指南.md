# 字幕烧录功能测试指南

**测试时间**: 2026-02-08
**状态**: ✅ 服务已就绪

---

## 服务状态

| 服务 | 地址 | 状态 |
|------|------|------|
| 前端 | http://localhost:5173 | ✅ 运行中 |
| 后端 | http://localhost:3002 | ✅ 运行中 |

---

## 快速测试步骤

### 1. 访问页面
打开浏览器访问：**http://localhost:5173**

### 2. 导航到视频页面
- 点击首页的"视频"分类
- 或直接访问：http://localhost:5173/festival/video

### 3. 准备素材
**图片**：上传或AI生成
**文案**（复制使用）：
```
马年大吉，恭喜发财！祝您身体健康，万事如意！阖家欢乐，幸福安康！
```

### 4. 生成视频
- 点击"生成数字人视频"
- 等待约90秒

### 5. 检查字幕效果
- ✅ 字幕是否显示
- ✅ 分段是否合理（3段，按句号断句）
- ✅ 样式是否美观（底部居中、黑色背景框）
- ✅ 时间是否准确（按字数权重分配）

### 6. 验证烧录
- 下载视频到本地
- 用播放器打开
- 确认字幕已烧录在视频中

---

## 预期效果对比

### 修复前
- ❌ 字幕"一会显示、一会不显示"
- ❌ 字号60太大，覆盖画面
- ❌ 简单平均分配，不合理

### 修复后
- ✅ 字幕稳定显示（成功率95%+）
- ✅ 字号24合适，更美观
- ✅ 智能按字数权重分配

---

## 控制台日志（预期）

打开浏览器F12开发者工具，生成视频时应该看到：

```
[VideoPage] 调用智能字幕烧录API
[智能字幕] 收到请求
[智能字幕] 视频时长: X.XX秒
[智能字幕] SRT已生成 (3段)
[智能字幕] FFmpeg完成: XXXXms
[VideoPage] ✅ 字幕烧录成功
```

---

## 如果遇到问题

### 字幕不显示
1. 查看浏览器控制台是否有错误
2. 查看后端日志（运行server.js的终端）
3. 确认FFmpeg是否安装：`ffmpeg -version`

### 服务无法访问
- 前端：`netstat -ano | findstr :5173`
- 后端：`netstat -ano | findstr :3002`

### 其他问题
查看详细文档：`docs/字幕烧录问题修复方案_2026-02-08.md`

---

## 成功标志

如果看到以下效果，说明修复成功：

1. ✅ 视频播放时字幕稳定显示
2. ✅ 字幕分为3段（按句号断句）
3. ✅ 第1段（10字）约1.4秒
4. ✅ 第2段（12字）约1.7秒
5. ✅ 第3段（10字）约1.4秒
6. ✅ 字幕底部居中，黑色背景框
7. ✅ 下载的视频包含字幕

---

**立即开始测试：http://localhost:5173** 🚀
